name: Code Quality Checks

on: [push, pull_request]

jobs:
  lint:
    name: Run Linters
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      # HTMLHint 检查
      - name: Run HTMLHint
        uses: tj-actions/htmlhint@v3
        with:
          htmlhint_config: .htmlhintrc

      # 安装 Node.js
      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20

      # 安装 Stylelint
      - name: Install Stylelint
        run: |
          npm init -y
          npm install stylelint stylelint-config-standard --save-dev

      # 创建基础配置（如果还没有）
      - name: Create default .stylelintrc.json
        run: |
          echo '{
            "extends": "stylelint-config-standard"
          }' > .stylelintrc.json
        if: ${{ !hashFiles('.stylelintrc.json') }}

      # 执行 Stylelint
      - name: Run Stylelint
        run: npx stylelint "**/*.css"

  check-size:
    name: Check Bundle Size
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: andresz1/size-limit-action@v1
